<% provide(:title, "Commitments") %>
<div id="content" class="interior">
  <a href="#content" class="sr-only">Content starts here.</a>

  <div class="splash">
    <div class="row">
      <div class="small-12 columns">
        <ul class="breadcrumbs" role="menubar" aria-label="Primary">
      <li class="parent"><%= link_to "Employment", "/employment" %></li>
          <li class="parent"><%= link_to "Employers", employer_home_path %></li>
          <li class="active">Commitments</li>
        </ul>
      </div>
    </div>
  </div>

  <% if user_signed_in? && current_user.is_employer? %>
  <% else %>
    <!-- employer not logged in -->
    <!-- @emilyville TODO: I commented this out until I pull in updated css from vets-website -->
    <!-- <div class="action-bar">
      <div class="row">
        <div class="small-12 columns">
          <h5>Employers:<br />Log in to create/manage your hiring commitment.</h5>
          <%= link_to "Sign in with LinkedIn", user_omniauth_authorize_path(:linkedin), class: "usa-button-primary social linkedin" %> 
          <%= link_to "Sign in with Google", user_omniauth_authorize_path(:google_oauth2), class: "usa-button-outline social googleplus" %>
        </div>
      </div>
    </div> -->
  <% end %>

  <div class="section one">
    <div class="row">
      <div class="small-12 medium-9 columns">
        <p>Employers from every industry and in every state have committed to hiring Veterans and military family members because these individuals have consistently proven themselves to be reliable, independent, and hardworking. </p>

        <p>By signing up and [making a commitment](vets.gov/signup), your company will stand out to candidates eager to enter the civilian workforce. There are also tax benefits to hiring Veterans, such as the Work Opportunity Tax Credit (WOTC), that range from $1,200 to $9,600. Other VA programs provide incentives to hiring Veterans, such as  [Vocational Rehabilitation and Employment](Vets.gov/voc-rehab.link) and [On-the-Job Training](Vets.gov/employerfacingOJTpage). </p>

        <p>You can regularly update your profile with the number of hires made. You can also share that number publicly. </p>

        <p>Read the RAND Corporation’s report titled <a href="http://www.rand.org/pubs/tools/TL160z1.html">What Veterans Bring to Civilian Workplaces </a>: A Prototype Toolkit for Helping Veterans Communicate to Private-Sector Employers About the Nontechnical Skills Taught in the Military. This publication demonstrates how courses such as Army Basic Combat Training, for example, teach attention to detail, teamwork, and persistence. Veterans have other soft skills such as problem solving and creativity that can benefit a company’s bottom line too. </p>

        <p>Make a commitment](vets.gov/signup). View current commitments. 
        [*this requires a design element]</p>

        <p>To learn more, call 1-800-827-1000 or visit a [VA regional office](link to regional office page).</p>
      </div>
    </div>

    <div class="row">
      <div class="small-12 medium-9 columns">
        <em> BEGINNING OF OLD COPY </em>
      </div>
    </div>

    <% unless user_signed_in? && current_user.is_employer? %>
      <div class="row">
          <div class="small-12 columns">
          <p>Employers every day are committing to hire Veterans &mdash; you should too! Check out the list below to see what employers have already made a commitment and then <%= link_to "create or update your profile", new_user_session_path %> to signal your commitment.</p>
        </div>
      </div><!-- end row 1 -->
    <% end %>

    <div class="row">
      <div class="small-12 medium-8 columns">
        <p>Of the <%= @commitment_report.total_employers %> approved employers with the Veteran Employment Center&trade;:</p>
        <ul class="plain">
          <li><strong><%= @commitment_report.total_commitments %></strong> public commitments made</li>
          <li><strong><%= @commitment_report.commitment_sum %></strong> total positions committed to hire</li>
          <li><strong><%= @commitment_report.hired_so_far %></strong> Veterans hired so far</li>
        </ul>
        <p><%= link_to 'Download all commitments as spreadsheet'.html_safe, action: 'commitments', format: :csv %></p>
      </div>
      <% if user_signed_in? && current_user.is_employer? %>
        <div class="small-12 medium-4 columns feature">
          <% if current_user.employer.commit_to_hire.present? %>
            <h5>You've publicly committed to hire <%= current_user.employer.commit_to_hire %> Veterans<% if current_user.employer.commit_date.present? %> by <%= current_user.employer.commit_date.strftime("%b %d, %Y") %><% end %>.<% if current_user.employer.commit_hired.present? %> So far, you've hired <%= current_user.employer.commit_hired %>.<% end %>
            </h5>
            <div class="actions">
              <%= link_to "Update Your Commitment", edit_employer_path(current_user.employer, anchor: 'hiring-commitments' ), class: 'button expand' %>
            </div>
          <% else %>
            <h5>You haven't yet made a public commitment to hire Veterans.</h5>
            <br/><br/>
            <div class="actions">
              <%= link_to "Make/Update Your Commitment", edit_employer_path(current_user.employer, anchor: 'hiring-commitments' ), class: 'button expand' %>
            </div>
          <% end %>
        </div>
      <% end %>
    </div><!-- end row 2 -->
    <div class="row">
      <h4>Commitments</h4>
      <table id="commitments" role="grid">
        <thead>
          <tr>
            <th scope="col">Company</th>
            <th scope="col">Committed to hire</th>
            <th scope="col">By date</th>
            <th scope="col">Hired so far</th>
          </tr>
        </thead>
        <tbody>
          <% @commitment_report.committed.each do |employer| %>
            <tr>
              <td class="employer_name">
                <%= render partial: 'commitment_summary', locals: {employer: employer} %>
              </td>
              <td><%= employer.commit_to_hire %></td>
              <td><%= employer.commit_date %></td>
              <td><%= employer.commit_hired %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
      <p>&nbsp;</p>
    </div><!-- end row 3 -->

  </div><!-- end section one -->

  <!-- Navigation -->
</div>


<script>
  $(document).ready(function(){
    $('#commitments').dataTable({
      'paging':    true,
      'info':      false,
      'searching': true,
        'order': [[1, "desc"]],
        'processing': true,
        'serverSide': true,
        'ajax': '<%= commitments_path %>',
        'columns': [
            {'data': 'summary'},
            {'data': 'commit_to_hire'},
            {'data': 'commit_date'},
            {'data': 'commit_hired'}

      ]

  });
});
</script>
